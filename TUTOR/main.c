#include <reg52.h>
//?1ms??
#define TIMS (65536 - 922)
sbit dc_an2= P2^3;
sbit dc_an1= P2^4;
unsigned char speed,compare;

//??ms??,?????????????
void delay_ms(unsigned int xms)   //@12MHz
{
    unsigned int i, j;
    for(i=xms;i>0;i--)
    {
        for(j=124;j>0;j--)
        {}
    }
}
                     
void main()
{
        TMOD = 0x01;      //?????0?16????,TH0?TL0??
        TH0 = TIMS >> 8;  //???????8?
        TL0 = TIMS;       //???????8?
        ET0 = 1;  //?????0??                                          
        EA  = 1;  //??????                                                      
        TR0 = 1;  //???0????  
        //?????,????
        dc_an1 = 0;
        dc_an2 = 0;  
        while(1){
            compare=10;
            delay_ms(5000);
            compare=30;
            delay_ms(5000);
            compare=60;
            delay_ms(5000);
            compare=90;
            delay_ms(5000);
        }
}

//1ms??????
void Timer0() interrupt 1
{
        //?????????????????? - 1????1???
        TH0 = TIMS >> 8;
        TL0 = TIMS;
        //?compare?10?,??10ms???,90ms???
        //?compare?60?,??60ms???,40ms???
        //?compare?90?,??90ms???,10ms???
        speed++;//?????????,1ms?1
        speed%=100;//??speed?0-100?
        if(speed<compare)//???????????
        {
            dc_an2=1;
        }
        else
        {       
            dc_an2=0;
        }
}

